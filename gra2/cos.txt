<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Zgadnij większą populację</title>
</head>
<body>
    <div id="div1" class="kraj"></div>
    <div id="div2" class="kraj"></div>
    <p>Poprawne odpowiedzi: <span id="poprawne">0</span></p>
    <p>Niepoprawne odpowiedzi: <span id="niepoprawne">0</span></p>

    <script>
        let poprawne = 0;
        let niepoprawne = 0;
        const maksNiepoprawne = 5;
        let daneKrajow = [];
        let kraj1, kraj2;

        async function getData() {
            const dane = await fetch('https://restcountries.com/v3.1/region/europe');
            daneKrajow = await dane.json();
            losujKraje();  // Uruchomienie losowania na początku
        }

        function losujKraje() {
            if (daneKrajow.length === 0) {
                console.error("Dane o krajach nie są jeszcze załadowane.");
                return;
            }

            const indeks1 = Math.floor(Math.random() * daneKrajow.length);
            let indeks2 = Math.floor(Math.random() * daneKrajow.length);

            if (indeks1 === indeks2) {
                indeks2 = (indeks2 + 1) % daneKrajow.length;
            }

            kraj1 = daneKrajow[indeks1];
            kraj2 = daneKrajow[indeks2];

            wyswietlKraj(kraj1, "div1");
            wyswietlKraj(kraj2, "div2");
        }

        function wyswietlKraj(kraj, divId) {
            const div = document.getElementById(divId);
            div.innerHTML = "";

            div.style.width = "325px";
            div.style.height = "400px";
            div.style.border = "1px solid black";
            div.style.textAlign = "center";
            div.style.backgroundColor = "honeydew";

            const img = document.createElement("img");
            img.setAttribute("src", kraj.flags.png);
            img.style.width = "325px";
            img.style.height = "180px";
            div.appendChild(img);

            const h1 = document.createElement("h1");
            h1.innerHTML = kraj.name.common;
            div.appendChild(h1);

            const btn = document.createElement("button");
            btn.textContent = "Wybierz ten kraj";
            btn.onclick = () => sprawdzOdpowiedz(kraj === kraj1 ? kraj1 : kraj2);
            div.appendChild(btn);

            const komunikat = document.createElement("p");
            komunikat.setAttribute("class", "komunikat");
            div.appendChild(komunikat);
        }

        function sprawdzOdpowiedz(wybranyKraj) {
            const div1Komunikat = document.querySelector("#div1 .komunikat");
            const div2Komunikat = document.querySelector("#div2 .komunikat");

            if (wybranyKraj.population >= (wybranyKraj === kraj1 ? kraj2 : kraj1).population) {
                poprawne++;
                document.getElementById("poprawne").textContent = poprawne;
                (wybranyKraj === kraj1 ? div1Komunikat : div2Komunikat).textContent = "Poprawna odpowiedź!";
                (wybranyKraj === kraj1 ? div2Komunikat : div1Komunikat).textContent = "";
            } else {
                niepoprawne++;
                document.getElementById("niepoprawne").textContent = niepoprawne;
                (wybranyKraj === kraj1 ? div1Komunikat : div2Komunikat).textContent = "Błędna odpowiedź!";
                (wybranyKraj === kraj1 ? div2Komunikat : div1Komunikat).textContent = "";
                if (niepoprawne >= maksNiepoprawne) {
                    alert("Gra zakończona! Przekroczono limit błędnych odpowiedzi.");
                    return;
                }
            }
            setTimeout(losujKraje, 1000);  // Po 1 sekundzie losujemy nowe kraje
        }

        window.onload = getData;
    </script>
</body>
</html>
